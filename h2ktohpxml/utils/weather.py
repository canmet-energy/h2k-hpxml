import difflib
from unidecode import unidecode

canadian_cwec_files = [
    "CAN_BC_ABBOTSFORD-A_1100031_CWEC",
    "CAN_BC_AGASSIZ-RCS_1100119_CWEC",
    "CAN_BC_BALLENAS-ISLAND_1020590_CWEC",
    "CAN_BC_BLUE-RIVER-CS_1160H99_CWEC",
    "CAN_BC_BONILLA-ISLAND-(AUT)_1060R0K_CWEC",
    "CAN_BC_BURNS-LAKE-DECKER-LAKE_1091174_CWEC",
    "CAN_BC_CALLAGHAN-VALLEY_1101300_CWEC",
    "CAN_BC_CAPE-ST-JAMES_1051351_CWEC",
    "CAN_BC_CATHEDRAL-POINT-(AUT)_1061458_CWEC",
    "CAN_BC_CLINTON-(AUT)_1161661_CWEC",
    "CAN_BC_COMOX-A_1021830_CWEC",
    "CAN_BC_CRANBROOK-A_1152105_CWEC",
    "CAN_BC_CRESTON-CAMPBELL-SCIENTIFIC_114B1F0_CWEC",
    "CAN_BC_CUMSHEWA-ISLAND_1062251_CWEC",
    "CAN_BC_DAWSON-CREEK-A_1182289_CWEC",
    "CAN_BC_DEASE-LAKE-(AUT)_119BLM0_CWEC",
    "CAN_BC_DISCOVERY-ISLAND_1012475_CWEC",
    "CAN_BC_ENTRANCE-ISLAND_1022689_CWEC",
    "CAN_BC_ESQUIMALT-HARBOUR_1012710_CWEC",
    "CAN_BC_ESTEVAN-POINT-CS_1032731_CWEC",
    "CAN_BC_FANNY-ISLAND_1022795_CWEC",
    "CAN_BC_FORT-NELSON-A_1192946_CWEC",
    "CAN_BC_FORT-ST-JOHN-A_1183001_CWEC",
    "CAN_BC_GREY-ISLET-(AUT)_1063303_CWEC",
    "CAN_BC_HERBERT-ISLAND-(AUT)_1063461_CWEC",
    "CAN_BC_HOLLAND-ROCK_1063496_CWEC",
    "CAN_BC_HOPE-A_1113542_CWEC",
    "CAN_BC_HOWE-SOUND---PAM-ROCKS_10459NN_CWEC",
    "CAN_BC_KAMLOOPS-A_1163781_CWEC",
    "CAN_BC_KELOWNA_1123939_CWEC",
    "CAN_BC_KINDAKUN-ROCKS-(AUT)_1054222_CWEC",
    "CAN_BC_LANGARA-ISLAND-RCS_1054503_CWEC",
    "CAN_BC_LILLOOET_1114619_CWEC",
    "CAN_BC_LUCY-ISLAND-LIGHTSTATION_1064728_CWEC",
    "CAN_BC_LYTTON-RCS_1114746_CWEC",
    "CAN_BC_MACKENZIE_1184791_CWEC",
    "CAN_BC_MALAHAT_1014820_CWEC",
    "CAN_BC_NAKUSP-CS_1145297_CWEC",
    "CAN_BC_NELSON-CS_1145M29_CWEC",
    "CAN_BC_OSOYOOS-CS_1125852_CWEC",
    "CAN_BC_PEMBERTON-AIRPORT-CS_1086082_CWEC",
    "CAN_BC_PENTICTON-A_1126146_CWEC",
    "CAN_BC_PITT-MEADOWS-CS_1106178_CWEC",
    "CAN_BC_POINT-ATKINSON_1106200_CWEC",
    "CAN_BC_PORT-HARDY-A_1026271_CWEC",
    "CAN_BC_PRINCE-GEORGE_1096439_CWEC",
    "CAN_BC_PRINCE-RUPERT_1066482_CWEC",
    "CAN_BC_PRINCETON-CS_112FN0M_CWEC",
    "CAN_BC_PUNTZI-MOUNTAIN-(AUT)_1086558_CWEC",
    "CAN_BC_QUESNEL_1096629_CWEC",
    "CAN_BC_REVELSTOKE-A_1176745_CWEC",
    "CAN_BC_ROSE-SPIT-(AUT)_1056869_CWEC",
    "CAN_BC_SALMON-ARM-CS_116FRMN_CWEC",
    "CAN_BC_SANDHEADS-CS_1107010_CWEC",
    "CAN_BC_SANDSPIT_1057052_CWEC",
    "CAN_BC_SARTINE-ISLAND-(AUT)_1037090_CWEC",
    "CAN_BC_SATURNA-ISLAND-CS_1017101_CWEC",
    "CAN_BC_SHERINGHAM-POINT_1017254_CWEC",
    "CAN_BC_SISTERS-ISLAND_1027403_CWEC",
    "CAN_BC_SMITHERS_1077499_CWEC",
    "CAN_BC_SOLANDER-ISLAND-(AUT)_1037553_CWEC",
    "CAN_BC_SPARWOOD-CS_1157631_CWEC",
    "CAN_BC_SQUAMISH-AIRPORT_10476F0_CWEC",
    "CAN_BC_SUMMERLAND-CS_112G8L1_CWEC",
    "CAN_BC_TATLAYOKO-LAKE-RCS_1088015_CWEC",
    "CAN_BC_TERRACE-A_1068134_CWEC",
    "CAN_BC_VANCOUVER-INTL-A_1108395_CWEC",
    "CAN_BC_VERNON-AUTO_1128582_CWEC",
    "CAN_BC_VICTORIA-GONZALES-CS_1018611_CWEC",
    "CAN_BC_VICTORIA-HARTLAND-CS_1018FJ5_CWEC",
    "CAN_BC_VICTORIA-INTL-A_1018621_CWEC",
    "CAN_BC_VICTORIA-UNIVERSITY-CS_1018598_CWEC",
    "CAN_BC_WARFIELD-RCS_1148705_CWEC",
    "CAN_BC_WEST-VANCOUVER-AUT_1108824_CWEC",
    "CAN_BC_WHISTLER---NESTERS_1100875_CWEC",
    "CAN_BC_WHITE-ROCK-CS_1108910_CWEC",
    "CAN_BC_WILLIAMS-LAKE-A_1098941_CWEC",
    "CAN_BC_YOHO-PARK_11790J1_CWEC",
    "CAN_AB_ABEE-AGDM_3010010_CWEC",
    "CAN_AB_ANDREW-AGDM_3010237_CWEC",
    "CAN_AB_ATMORE-AGDM_3060406_CWEC",
    "CAN_AB_BANFF-CS_3050519_CWEC",
    "CAN_AB_BARNWELL-AGDM_3030525_CWEC",
    "CAN_AB_BARRHEAD-CS_3060535_CWEC",
    "CAN_AB_BEAVERLODGE-RCS_3070600_CWEC",
    "CAN_AB_BLOOD-TRIBE-AGDM_3030720_CWEC",
    "CAN_AB_BODO-AGDM_3010730_CWEC",
    "CAN_AB_BOW-ISLAND-IRRIGATION-AGDM_3030772_CWEC",
    "CAN_AB_BOW-ISLAND_3030768_CWEC",
    "CAN_AB_BOW-VALLEY_3050778_CWEC",
    "CAN_AB_BRETON-PLOTS_3010816_CWEC",
    "CAN_AB_BROCKET-AGDM_3030830_CWEC",
    "CAN_AB_BROOKS_3030QLP_CWEC",
    "CAN_AB_CALGARY-INTL-A_3031092_CWEC",
    "CAN_AB_CAMROSE_3011240_CWEC",
    "CAN_AB_CARDSTON_3031322_CWEC",
    "CAN_AB_CHAMPION-AGDM_3031480_CWEC",
    "CAN_AB_CLARESHOLM_3031640_CWEC",
    "CAN_AB_CLEARDALE-AGDM_3074935_CWEC",
    "CAN_AB_COLD-LAKE-A_3081680_CWEC",
    "CAN_AB_CONSORT-AGDM_3011815_CWEC",
    "CAN_AB_COP-UPPER_3031875_CWEC",
    "CAN_AB_CORONATION-CLIMATE_3011887_CWEC",
    "CAN_AB_CROWSNEST_3051R4R_CWEC",
    "CAN_AB_DAPP-AGDM_3061975_CWEC",
    "CAN_AB_DEL-BONITA-AGDM_3042045_CWEC",
    "CAN_AB_DRUMHELLER-EAST_30221LG_CWEC",
    "CAN_AB_EDMONTON-CITY-CENTRE-AWOS_3012202_CWEC",
    "CAN_AB_EDMONTON-INTL-A_3012216_CWEC",
    "CAN_AB_EDMONTON-STONY-PLAIN-CS_301A001_CWEC",
    "CAN_AB_EDSON-CLIMATE_3062246_CWEC",
    "CAN_AB_ELK-ISLAND-NAT-PARK_3012275_CWEC",
    "CAN_AB_ENCHANT-AGDM_3032422_CWEC",
    "CAN_AB_ESTHER-1_301B460_CWEC",
    "CAN_AB_FAIRVIEW-AGDM_3072525_CWEC",
    "CAN_AB_FINCASTLE-AGDM_3032550_CWEC",
    "CAN_AB_FOREMOST-AGDM_3032642_CWEC",
    "CAN_AB_FORT-CHIPEWYAN_3072655_CWEC",
    "CAN_AB_FORT-MCMURRAY-A_3062697_CWEC",
    "CAN_AB_FORT-VERMILION_3072723_CWEC",
    "CAN_AB_GARDEN-RIVER_307KPFP_CWEC",
    "CAN_AB_GRANDE-PRAIRIE-A_3072921_CWEC",
    "CAN_AB_HENDRICKSON-CREEK_3063135_CWEC",
    "CAN_AB_HIGH-LEVEL_3073140_CWEC",
    "CAN_AB_HIGH-PRAIRIE-AGDM_3063165_CWEC",
    "CAN_AB_HOLDEN-AGDM_3013340_CWEC",
    "CAN_AB_HUSSAR-AGDM_3023402_CWEC",
    "CAN_AB_IRON-SPRINGS-AGDM_3033498_CWEC",
    "CAN_AB_JASPER-WARDEN_3053536_CWEC",
    "CAN_AB_KILLAM-AGDM_3013640_CWEC",
    "CAN_AB_LAC-LA-BICHE-CLIMATE_3063686_CWEC",
    "CAN_AB_LACOMBE-CDA-2_3023722_CWEC",
    "CAN_AB_LETHBRIDGE-CDA_3033890_CWEC",
    "CAN_AB_LETHBRIDGE-DEMO-FARM-AGDM_3033897_CWEC",
    "CAN_AB_LLOYDMINSTER-A_3013959_CWEC",
    "CAN_AB_MANNING-AGDM_3074190_CWEC",
    "CAN_AB_MASINASIN-AGDM_3044232_CWEC",
    "CAN_AB_MEDICINE-HAT-RCS_3034485_CWEC",
    "CAN_AB_MILDRED-LAKE_3064528_CWEC",
    "CAN_AB_MILK-RIVER_3044533_CWEC",
    "CAN_AB_MORRIN-AGDM_3024668_CWEC",
    "CAN_AB_MUNDARE-AGDM_3014665_CWEC",
    "CAN_AB_NAKISKA-RIDGETOP_305MGFF_CWEC",
    "CAN_AB_NORDEGG-CS_3054843_CWEC",
    "CAN_AB_OLDS-AGDM_3024925_CWEC",
    "CAN_AB_OLIVER-AGDM_3014921_CWEC",
    "CAN_AB_ONEFOUR-CDA_3044923_CWEC",
    "CAN_AB_OYEN-AGDM_3024965_CWEC",
    "CAN_AB_PEACE-RIVER-A_3075041_CWEC",
    "CAN_AB_PEORIA-AGDM_3075160_CWEC",
    "CAN_AB_PINCHER-CREEK_3035198_CWEC",
    "CAN_AB_POLLOCKVILLE-AGDM_3025243_CWEC",
    "CAN_AB_PRENTISS_3025297_CWEC",
    "CAN_AB_RAYMOND-AGDM_3035422_CWEC",
    "CAN_AB_RED-DEER-REGIONAL-A_3025481_CWEC",
    "CAN_AB_RED-EARTH_3075488_CWEC",
    "CAN_AB_RICH-LAKE-AGDM_3065475_CWEC",
    "CAN_AB_ROCKY-MTN-HOUSE-(AUT)_3015523_CWEC",
    "CAN_AB_SCHULER-AGDM_3025768_CWEC",
    "CAN_AB_SEVEN-PERSONS-AGDM_3035845_CWEC",
    "CAN_AB_SLAVE-LAKE_3065995_CWEC",
    "CAN_AB_SMOKY-LAKE-AGDM_3016022_CWEC",
    "CAN_AB_SPIRIT-RIVER-AUTO-STATION_3076069_CWEC",
    "CAN_AB_ST-PAUL-AGCM_3015676_CWEC",
    "CAN_AB_STAVELY-AAFC_3036099_CWEC",
    "CAN_AB_STETTLER-AGDM_3016124_CWEC",
    "CAN_AB_STRATHMORE-AGDM_3036205_CWEC",
    "CAN_AB_SUNDRE-A_3026KNQ_CWEC",
    "CAN_AB_THREE-HILLS_3026479_CWEC",
    "CAN_AB_TWO-HILLS-AGDM_3016655_CWEC",
    "CAN_AB_VALLEYVIEW-AGDM_3076680_CWEC",
    "CAN_AB_VAUXHALL-CDA-CS_3036682_CWEC",
    "CAN_AB_VEGREVILLE_3016GF0_CWEC",
    "CAN_AB_VERMILION-AGDM_3016802_CWEC",
    "CAN_AB_VIOLET-GROVE-CS_3016860_CWEC",
    "CAN_AB_WAINWRIGHT-CFB-AIRFIELD-21_301S001_CWEC",
    "CAN_AB_WATERTON-PARK-GATE_3056214_CWEC",
    "CAN_AB_WHITECOURT-A_3057376_CWEC",
    "CAN_AB_WILLOW-CREEK-1_306GE70_CWEC",
    "CAN_AB_WRENTHAM-AGDM_3037675_CWEC",
    "CAN_SK_ASSINIBOIA-AIRPORT_4020286_CWEC",
    "CAN_SK_BROADVIEW_4010879_CWEC",
    "CAN_SK_BUFFALO-NARROWS-(AUT)_4060983_CWEC",
    "CAN_SK_COLLINS-BAY-SK_4061620_CWEC",
    "CAN_SK_CORONACH-SPC_40318MN_CWEC",
    "CAN_SK_CYPRESS-HILLS-PARK_4031999_CWEC",
    "CAN_SK_EASTEND-CYPRESS-(AUT)_4032322_CWEC",
    "CAN_SK_ELBOW-CS_4022359_CWEC",
    "CAN_SK_ESTEVAN-A_4012401_CWEC",
    "CAN_SK_HUDSON-BAY(AUT)_4083324_CWEC",
    "CAN_SK_INDIAN-HEAD-CDA_4013480_CWEC",
    "CAN_SK_ISLAND-FALLS-(AUT)_4063605_CWEC",
    "CAN_SK_JIMMY-LAKE-AWOS_4063623_CWEC",
    "CAN_SK_KEY-LAKE-A_4063757_CWEC",
    "CAN_SK_KINDERSLEY-A_4043901_CWEC",
    "CAN_SK_LA-RONGE-A_4064155_CWEC",
    "CAN_SK_LAST-MOUNTAIN-CS_4014156_CWEC",
    "CAN_SK_LEADER-AIRPORT_402DAF0_CWEC",
    "CAN_SK_LUCKY-LAKE_4024714_CWEC",
    "CAN_SK_MAPLE-CREEK_4024919_CWEC",
    "CAN_SK_MEADOW-LAKE_406N0NM_CWEC",
    "CAN_SK_MELFORT_4055079_CWEC",
    "CAN_SK_MOOSE-JAW-CS_4015322_CWEC",
    "CAN_SK_NIPAWIN_407N51G_CWEC",
    "CAN_SK_NORTH-BATTLEFORD_4045695_CWEC",
    "CAN_SK_OUTLOOK-PFRA_4055736_CWEC",
    "CAN_SK_PRINCE-ALBERT-A_4056241_CWEC",
    "CAN_SK_REGINA-INTL-A_4016566_CWEC",
    "CAN_SK_ROCKGLEN-(AUT)_4036844_CWEC",
    "CAN_SK_ROSETOWN-EAST_4046884_CWEC",
    "CAN_SK_SASKATOON-INTL-A_4057152_CWEC",
    "CAN_SK_SCOTT-CDA_4047240_CWEC",
    "CAN_SK_SOUTHEND_4067655_CWEC",
    "CAN_SK_SPIRITWOOD-WEST_4067723_CWEC",
    "CAN_SK_STONY-RAPIDS_4067799_CWEC",
    "CAN_SK_SWIFT-CURRENT-CDA_4028060_CWEC",
    "CAN_SK_SWIFT-CURRENT_4028038_CWEC",
    "CAN_SK_URANIUM-CITY-(AUT)_406QLD0_CWEC",
    "CAN_SK_VAL-MARIE-SOUTHEAST_4038412_CWEC",
    "CAN_SK_WASKESIU-LAKE_4068559_CWEC",
    "CAN_SK_WATROUS-EAST_4018642_CWEC",
    "CAN_SK_WEYBURN_401HP5R_CWEC",
    "CAN_SK_WYNYARD-(AUT)_40190LN_CWEC",
    "CAN_SK_YORKTON_4019075_CWEC",
    "CAN_MB_BERENS-RIVER-CS_5030203_CWEC",
    "CAN_MB_BRANDON-A_5010481_CWEC",
    "CAN_MB_CARBERRY-CS_5010547_CWEC",
    "CAN_MB_CARMAN-U-OF-M-CS_502I001_CWEC",
    "CAN_MB_CHURCHILL-A_5060605_CWEC",
    "CAN_MB_DAUPHIN_5040689_CWEC",
    "CAN_MB_DEERWOOD-RCS_5020725_CWEC",
    "CAN_MB_DELTA-MARSH-CS_5040764_CWEC",
    "CAN_MB_EMERSON-AUTO_5020881_CWEC",
    "CAN_MB_FISHER-BRANCH-(AUT)_50309J6_CWEC",
    "CAN_MB_FLIN-FLON_5050919_CWEC",
    "CAN_MB_GEORGE-ISLAND-(AUT)_5030984_CWEC",
    "CAN_MB_GILLAM-A_5061022_CWEC",
    "CAN_MB_GIMLI-CLIMATE_5031042_CWEC",
    "CAN_MB_GIMLI-HARBOUR-CS_5031041_CWEC",
    "CAN_MB_GRAND-RAPIDS-(AUT)_5031A10_CWEC",
    "CAN_MB_GRETNA-(AUT)_5021220_CWEC",
    "CAN_MB_ISLAND-LAKE-A_5061375_CWEC",
    "CAN_MB_KELSEY-DAM-CS_5061422_CWEC",
    "CAN_MB_LYNN-LAKE_5061645_CWEC",
    "CAN_MB_MCCREARY_5043158_CWEC",
    "CAN_MB_MELITA_501A7AR_CWEC",
    "CAN_MB_MORDEN-CDA-CS_5021849_CWEC",
    "CAN_MB_NORWAY-HOUSE_5062040_CWEC",
    "CAN_MB_OAKPOINT-MARINE_504K0NM_CWEC",
    "CAN_MB_PILOT-MOUND-(AUT)_5022125_CWEC",
    "CAN_MB_PINAWA_503B1ER_CWEC",
    "CAN_MB_PORTAGE-SOUTHPORT_5012324_CWEC",
    "CAN_MB_ROBLIN_5012469_CWEC",
    "CAN_MB_SHOAL-LAKE-CS_5012654_CWEC",
    "CAN_MB_SPRAGUE_5022759_CWEC",
    "CAN_MB_SWAN-RIVER-RCS_504K80K_CWEC",
    "CAN_MB_TADOULE-LAKE-CS_5062840_CWEC",
    "CAN_MB_THE-PAS-A_5052881_CWEC",
    "CAN_MB_THOMPSON-A_5062921_CWEC",
    "CAN_MB_VICTORIA-BEACH-(AUT)_5032951_CWEC",
    "CAN_MB_WASAGAMING_5013117_CWEC",
    "CAN_MB_WINNIPEG-INTL-A_5023227_CWEC",
    "CAN_MB_WINNIPEG-THE-FORKS_5023262_CWEC",
    "CAN_ON_ALGONQUIN-PARK-EAST-GATE_6080192_CWEC",
    "CAN_ON_ARMSTRONG-(AUT)_6040325_CWEC",
    "CAN_ON_ATIKOKAN-(AUT)_6020LPQ_CWEC",
    "CAN_ON_BANCROFT-AUTO_616I001_CWEC",
    "CAN_ON_BARRIE-ORO_6117700_CWEC",
    "CAN_ON_BIG-TROUT-LAKE-A_6010735_CWEC",
    "CAN_ON_BORDEN-AWOS_611B002_CWEC",
    "CAN_ON_BURLINGTON-PIERS-(AUT)_6151061_CWEC",
    "CAN_ON_CAMERON-FALLS-(AUT)_6041110_CWEC",
    "CAN_ON_COBOURG-(AUT)_6151684_CWEC",
    "CAN_ON_COLLINGWOOD_6111792_CWEC",
    "CAN_ON_DELHI-CS_6131983_CWEC",
    "CAN_ON_DRYDEN-REGIONAL_6032125_CWEC",
    "CAN_ON_EAR-FALLS-(AUT)_6012199_CWEC",
    "CAN_ON_EARLTON-A_6072223_CWEC",
    "CAN_ON_EGBERT-CS_611E001_CWEC",
    "CAN_ON_ELORA-RCS_6142286_CWEC",
    "CAN_ON_ERIEAU-(AUT)_613KLLM_CWEC",
    "CAN_ON_GERALDTON-A_6042716_CWEC",
    "CAN_ON_GODERICH_6122847_CWEC",
    "CAN_ON_GORE-BAY-CLIMATE_6092920_CWEC",
    "CAN_ON_HAMILTON-A_6153193_CWEC",
    "CAN_ON_HAMILTON-RBG-CS_6153301_CWEC",
    "CAN_ON_HARROW-CDA-AUTO_6133362_CWEC",
    "CAN_ON_KAPUSKASING-A_6073976_CWEC",
    "CAN_ON_KEMPTVILLE-CS_6104027_CWEC",
    "CAN_ON_KENORA-A_6034076_CWEC",
    "CAN_ON_KILLARNEY-(AUT)_605DJ25_CWEC",
    "CAN_ON_KIRKLAND-LAKE-CS_6074211_CWEC",
    "CAN_ON_LAGOON-CITY_6114295_CWEC",
    "CAN_ON_LANSDOWNE-HOUSE-(AUT)_6014353_CWEC",
    "CAN_ON_LONDON-A_6144473_CWEC",
    "CAN_ON_MOOSONEE_6075420_CWEC",
    "CAN_ON_MOUNT-FOREST-(AUT)_6145504_CWEC",
    "CAN_ON_MUSKOKA_6115529_CWEC",
    "CAN_ON_NAGAGAMI-(AUT)_6075543_CWEC",
    "CAN_ON_NORTH-BAY-A_6085680_CWEC",
    "CAN_ON_OTTAWA-INTL-A_6106001_CWEC",
    "CAN_ON_PARRY-SOUND-CCG_6116257_CWEC",
    "CAN_ON_PEAWANUCK-(AUT)_6016295_CWEC",
    "CAN_ON_PETERBOROUGH_6166415_CWEC",
    "CAN_ON_PICKLE-LAKE-(AUT)_6016525_CWEC",
    "CAN_ON_POINT-PELEE-CS_613P001_CWEC",
    "CAN_ON_POINT-PETRE-(AUT)_6156559_CWEC",
    "CAN_ON_PORT-WELLER-(AUT)_6136699_CWEC",
    "CAN_ON_PUKASKWA-(AUT)_6046768_CWEC",
    "CAN_ON_SAULT-STE-MARIE-A_6057591_CWEC",
    "CAN_ON_SIOUX-LOOKOUT-A_6037776_CWEC",
    "CAN_ON_SUDBURY-A_6068153_CWEC",
    "CAN_ON_THUNDER-BAY-A_6048262_CWEC",
    "CAN_ON_TIMMINS-A_6078286_CWEC",
    "CAN_ON_TORONTO-BUTTONVILLE-A_615HMAK_CWEC",
    "CAN_ON_TORONTO-CITY-CENTRE_6158359_CWEC",
    "CAN_ON_TORONTO-CITY_6158355_CWEC",
    "CAN_ON_TORONTO-INTL-A_6158731_CWEC",
    "CAN_ON_TRENTON-A_6158875_CWEC",
    "CAN_ON_UPSALA-(AUT)_6049095_CWEC",
    "CAN_ON_VINELAND-STATION-RCS_6139148_CWEC",
    "CAN_ON_WAWA-(AUT)_6059408_CWEC",
    "CAN_ON_WIARTON-A_6119500_CWEC",
    "CAN_ON_WINDSOR-A_6139527_CWEC",
    "CAN_QC_AMQUI_7050145_CWEC",
    "CAN_QC_BAGOTVILLE-A_7060400_CWEC",
    "CAN_QC_BAIE-COMEAU-A_7040442_CWEC",
    "CAN_QC_BAIE-COMEAU_704S001_CWEC",
    "CAN_QC_BARRAGE-TEMISCAMINGUE_7080468_CWEC",
    "CAN_QC_BEAUCEVILLE_7028754_CWEC",
    "CAN_QC_BEAUPORT_7010565_CWEC",
    "CAN_QC_BONNARD-1_7060826_CWEC",
    "CAN_QC_CAP-D'ESPOIR_7051050_CWEC",
    "CAN_QC_CAP-MADELEINE_7051163_CWEC",
    "CAN_QC_CAP-ROUGE_7041166_CWEC",
    "CAN_QC_CAP-TOURMENTE_7041JG6_CWEC",
    "CAN_QC_CAPE-WHITTLE_7041100_CWEC",
    "CAN_QC_CHAMOUCHOUANE_7061288_CWEC",
    "CAN_QC_CHAPAIS_7091299_CWEC",
    "CAN_QC_CHARLEVOIX-(MRC)_7041312_CWEC",
    "CAN_QC_CHEVERY_7041382_CWEC",
    "CAN_QC_CHUTE-DES-PASSES_7061541_CWEC",
    "CAN_QC_DESCHAMBAULT_7011983_CWEC",
    "CAN_QC_FORET-MONTMORENCY-RCS_7042395_CWEC",
    "CAN_QC_FRELIGHSBURG_7022579_CWEC",
    "CAN_QC_GASPE-A_7052601_CWEC",
    "CAN_QC_HAVRE-ST.-PIERRE_7043019_CWEC",
    "CAN_QC_HIGH-FALLS_7033121_CWEC",
    "CAN_QC_ILE-AUX-PERROQUETS_7043B79_CWEC",
    "CAN_QC_ILE-ROUGE_7043BP9_CWEC",
    "CAN_QC_ILES-DE-LA-MADELEINE_7053KGR_CWEC",
    "CAN_QC_INUKJUAK-A_710S005_CWEC",
    "CAN_QC_JONQUIERE_7063370_CWEC",
    "CAN_QC_KUUJJUAQ-A_7113535_CWEC",
    "CAN_QC_KUUJJUARAPIK-A_7103537_CWEC",
    "CAN_QC_L'ACADIE_702LED4_CWEC",
    "CAN_QC_L'ASSOMPTION_7014160_CWEC",
    "CAN_QC_L'ETAPE_7015791_CWEC",
    "CAN_QC_LA-BAIE_706Q001_CWEC",
    "CAN_QC_LA-POCATIERE_7054096_CWEC",
    "CAN_QC_LA-TUQUE_707DBD4_CWEC",
    "CAN_QC_LAC-BENOIT_706I001_CWEC",
    "CAN_QC_LAC-EON_704C64L_CWEC",
    "CAN_QC_LAC-MEMPHREMAGOG_702CFGG_CWEC",
    "CAN_QC_LAC-SAINT-PIERRE_701LP0N_CWEC",
    "CAN_QC_LATERRIERE_7064181_CWEC",
    "CAN_QC_LEMIEUX_701Q009_CWEC",
    "CAN_QC_LENNOXVILLE_7024280_CWEC",
    "CAN_QC_LONGUE-POINTE-DE-MINGAN_7044328_CWEC",
    "CAN_QC_LOURDES-DE-BLANC-SABLON-A_7040815_CWEC",
    "CAN_QC_MANIWAKI-AIRPORT_7034482_CWEC",
    "CAN_QC_MANOUANE-EST_706I155_CWEC",
    "CAN_QC_MATAGAMI-A_7094636_CWEC",
    "CAN_QC_MCTAVISH_7024745_CWEC",
    "CAN_QC_MONT-JOLI-A_7055121_CWEC",
    "CAN_QC_MONTREAL-EST_7025252_CWEC",
    "CAN_QC_MONTREAL-INTL-A_7025251_CWEC",
    "CAN_QC_MONTREAL-MIRABEL-INTL-A_7034900_CWEC",
    "CAN_QC_MONTREAL-ST-HUBERT_7027329_CWEC",
    "CAN_QC_NATASHQUAN-A_7045401_CWEC",
    "CAN_QC_NEW-CARLISLE-1_7055422_CWEC",
    "CAN_QC_NICOLET_7025442_CWEC",
    "CAN_QC_NORMANDIN_7065639_CWEC",
    "CAN_QC_PARENT_7075800_CWEC",
    "CAN_QC_POINTE-AU-PERE-(INRS)_7056068_CWEC",
    "CAN_QC_POINTE-CLAVEAU_704607C_CWEC",
    "CAN_QC_POINTE-DE-L'ISLET_7046059_CWEC",
    "CAN_QC_POINTE-DES-MONTS_704F0PN_CWEC",
    "CAN_QC_POINTE-NOIRE-CS_704Q003_CWEC",
    "CAN_QC_PORT-MENIER_7056202_CWEC",
    "CAN_QC_QUEBEC-INTL-A_7016293_CWEC",
    "CAN_QC_RIVIERE-DU-LOUP_7056616_CWEC",
    "CAN_QC_ROBERVAL-A_7066686_CWEC",
    "CAN_QC_ROUYN-NORANDA-A_7086719_CWEC",
    "CAN_QC_ROUYN_7086716_CWEC",
    "CAN_QC_SCHEFFERVILLE-A_7117823_CWEC",
    "CAN_QC_SEPT-ILES-A_7047911_CWEC",
    "CAN_QC_SHAWINIGAN_7018001_CWEC",
    "CAN_QC_ST-ANICET-1_702FQLF_CWEC",
    "CAN_QC_ST-JOVITE_703GDKB_CWEC",
    "CAN_QC_STE-ANNE-DE-BELLEVUE-1_702FHL8_CWEC",
    "CAN_QC_STE-CLOTHILDE_7027039_CWEC",
    "CAN_QC_STE-FOY-(U.-LAVAL)_701Q004_CWEC",
    "CAN_QC_VAL-D'OR_7098603_CWEC",
    "CAN_QC_VARENNES_702327X_CWEC",
    "CAN_NB_BAS-CARAQUET_8100467_CWEC",
    "CAN_NB_BATHURST-A_8100505_CWEC",
    "CAN_NB_CHARLO-AUTO_8100885_CWEC",
    "CAN_NB_EDMUNDSTON_8101303_CWEC",
    "CAN_NB_FREDERICTON_8101505_CWEC",
    "CAN_NB_GRAND-MANAN-SAR-CS_8101925_CWEC",
    "CAN_NB_MIRAMICHI-RCS_8100989_CWEC",
    "CAN_NB_MISCOU-ISLAND-(AUT)_8103050_CWEC",
    "CAN_NB_MONCTON-INTL-A_8103201_CWEC",
    "CAN_NB_POINT-LEPREAU-CS_8104201_CWEC",
    "CAN_NB_SAINT-JOHN-A_8104901_CWEC",
    "CAN_NB_ST-LEONARD-CS_810I001_CWEC",
    "CAN_NB_ST.-STEPHEN_8104935_CWEC",
    "CAN_PE_CHARLOTTETOWN-A_8300301_CWEC",
    "CAN_PE_EAST-POINT-(AUT)_8300418_CWEC",
    "CAN_PE_HARRINGTON-CDA-CS_830P001_CWEC",
    "CAN_PE_MAPLE-PLAINS_8305500_CWEC",
    "CAN_PE_NORTH-CAPE_8300516_CWEC",
    "CAN_PE_ST.-PETERS_8300562_CWEC",
    "CAN_PE_SUMMERSIDE_8300596_CWEC",
    "CAN_NS_BEAVER-ISLAND-(AUT)_8200558_CWEC",
    "CAN_NS_BEDFORD-BASIN_8200573_CWEC",
    "CAN_NS_BEDFORD-RANGE_8200574_CWEC",
    "CAN_NS_BRIER-ISLAND_8200604_CWEC",
    "CAN_NS_CARIBOU-POINT-(AUT)_8200774_CWEC",
    "CAN_NS_CHETICAMP-CS_8200827_CWEC",
    "CAN_NS_DEBERT_8201390_CWEC",
    "CAN_NS_GRAND-ETANG_8201969_CWEC",
    "CAN_NS_GREENWOOD-A_8202000_CWEC",
    "CAN_NS_HALIFAX-DOCKYARD_8202240_CWEC",
    "CAN_NS_HALIFAX-INTL-A_8202251_CWEC",
    "CAN_NS_HART-ISLAND-(AUT)_8202318_CWEC",
    "CAN_NS_INGONISH-BEACH-RCS_8202502_CWEC",
    "CAN_NS_KEJIMKUJIK-1_8202592_CWEC",
    "CAN_NS_KENTVILLE-CDA-CS_8202810_CWEC",
    "CAN_NS_LUNENBURG_8203210_CWEC",
    "CAN_NS_MALAY-FALLS_8203405_CWEC",
    "CAN_NS_MCNABS-ISLAND-(AUT)_8203478_CWEC",
    "CAN_NS_NAPPAN-AUTO_8203702_CWEC",
    "CAN_NS_NORTH-MOUNTAIN-CS_8204161_CWEC",
    "CAN_NS_NORTHEAST-MARGAREE-(AUT)_8204154_CWEC",
    "CAN_NS_PARRSBORO_8204402_CWEC",
    "CAN_NS_SABLE-ISLAND-A_8204703_CWEC",
    "CAN_NS_SHEARWATER-RCS_8205092_CWEC",
    "CAN_NS_ST-PAUL-ISLAND-(AUT)_8204909_CWEC",
    "CAN_NS_SYDNEY-A_8205701_CWEC",
    "CAN_NS_TRACADIE_8205895_CWEC",
    "CAN_NS_WESTERN-HEAD_8206240_CWEC",
    "CAN_NS_YARMOUTH-A_8206495_CWEC",
    "CAN_NL_ARGENTIA-(AUT)_8400104_CWEC",
    "CAN_NL_BADGER-(AUT)_8400301_CWEC",
    "CAN_NL_BONAVISTA_8400601_CWEC",
    "CAN_NL_BURGEO-NL_8400801_CWEC",
    "CAN_NL_CAPE-RACE-(AUT)_8401000_CWEC",
    "CAN_NL_CARTWRIGHT-A_8501101_CWEC",
    "CAN_NL_CHURCHILL-FALLS_8501131_CWEC",
    "CAN_NL_CORNER-BROOK_8401298_CWEC",
    "CAN_NL_DANIELS-HARBOUR_8401400_CWEC",
    "CAN_NL_DEER-LAKE-A_8401502_CWEC",
    "CAN_NL_ENGLEE-(AUT)_8401538_CWEC",
    "CAN_NL_FEROLLE-POINT-(AUT)_8401565_CWEC",
    "CAN_NL_GANDER-INTL-A_8401703_CWEC",
    "CAN_NL_GOOSE-A_8501900_CWEC",
    "CAN_NL_HOPEDALE-(AUT)_8502400_CWEC",
    "CAN_NL_LA-SCIE_8402520_CWEC",
    "CAN_NL_MARY'S-HARBOUR-A_8502592_CWEC",
    "CAN_NL_PORT-AUX-BASQUES_8402975_CWEC",
    "CAN_NL_ROCKY-HARBOUR-CS_8403097_CWEC",
    "CAN_NL_SAGONA-ISLAND_8403255_CWEC",
    "CAN_NL_ST-LAWRENCE_8403619_CWEC",
    "CAN_NL_ST.-JOHN'S-INTL-A_8403505_CWEC",
    "CAN_NL_STEPHENVILLE-A_8403801_CWEC",
    "CAN_NL_TERRA-NOVA-NAT-PARK-CS_8403851_CWEC",
    "CAN_NL_TWILLINGATE-(AUT)_8404025_CWEC",
    "CAN_NL_WABUSH-A_8504177_CWEC",
    "CAN_NL_WINTERLAND_8404241_CWEC",
    "CAN_NL_WRECKHOUSE_8404343_CWEC",
    "CAN_YT_BURWASH-A_2100181_CWEC",
    "CAN_YT_CARMACKS-CS_2100301_CWEC",
    "CAN_YT_DAWSON_2100LRP_CWEC",
    "CAN_YT_FARO-(AUT)_2100518_CWEC",
    "CAN_YT_HAINES-JUNCTION_2100630_CWEC",
    "CAN_YT_HERSCHEL-ISLAND_2100636_CWEC",
    "CAN_YT_IVVAVIK-NAT.-PARK_2100660_CWEC",
    "CAN_YT_MACMILLAN-PASS_2100693_CWEC",
    "CAN_YT_MAYO-A_2100701_CWEC",
    "CAN_YT_OLD-CROW-RCS_2100805_CWEC",
    "CAN_YT_ROCK-RIVER_2100935_CWEC",
    "CAN_YT_TESLIN-(AUT)_2101102_CWEC",
    "CAN_YT_WATSON-LAKE-A_2101201_CWEC",
    "CAN_YT_WHITEHORSE-A_2101303_CWEC",
    "CAN_NT_DEADMEN-VALLEY_22010H0_CWEC",
    "CAN_NT_DELINE-CS_2201022_CWEC",
    "CAN_NT_FORT-GOOD-HOPE-CS_2201450_CWEC",
    "CAN_NT_FORT-LIARD_2201579_CWEC",
    "CAN_NT_FORT-PROVIDENCE_2201799_CWEC",
    "CAN_NT_FORT-RELIANCE-(AUT)_2201903_CWEC",
    "CAN_NT_FORT-SIMPSON-A_2202103_CWEC",
    "CAN_NT_FORT-SMITH-A_2202201_CWEC",
    "CAN_NT_HAY-RIVER-A_2202401_CWEC",
    "CAN_NT_HOLMAN-CS_2502505_CWEC",
    "CAN_NT_INNER-WHALEBACKS_2202560_CWEC",
    "CAN_NT_INUVIK-A_2202571_CWEC",
    "CAN_NT_KEATS-POINT_2202663_CWEC",
    "CAN_NT_LAC-LA-MARTRE_2202678_CWEC",
    "CAN_NT_LINDBURG-LANDING_220N003_CWEC",
    "CAN_NT_LITTLE-CHICAGO_220B6Q3_CWEC",
    "CAN_NT_LIVERPOOL-BAY_220B68C_CWEC",
    "CAN_NT_LOWER-CARP-LAKE_220N004_CWEC",
    "CAN_NT_LUTSELK'E-CS_220L002_CWEC",
    "CAN_NT_MOULD-BAY-CS_250M001_CWEC",
    "CAN_NT_NORMAN-WELLS-A_2202801_CWEC",
    "CAN_NT_PAULATUK_2203058_CWEC",
    "CAN_NT_PELLY-ISLAND_2203095_CWEC",
    "CAN_NT_RABBIT-KETTLE_2203342_CWEC",
    "CAN_NT_SACHS-HARBOUR-CLIMATE_2503648_CWEC",
    "CAN_NT_STORM-HILLS_220LQJJ_CWEC",
    "CAN_NT_THOMSEN-RIVER_2503886_CWEC",
    "CAN_NT_TRAIL-VALLEY_220N005_CWEC",
    "CAN_NT_TUKTOYAKTUK_2203914_CWEC",
    "CAN_NT_YELLOWKNIFE-A_2204101_CWEC",
    "CAN_NT_YOHIN_2204300_CWEC",
    "CAN_NU_ALERT-CLIMATE_2400305_CWEC",
    "CAN_NU_ARCTIC-BAY-CS_2400404_CWEC",
    "CAN_NU_ARVIAT-CLIMATE_2301153_CWEC",
    "CAN_NU_BAKER-LAKE-A_2300503_CWEC",
    "CAN_NU_BREVOORT-ISLAND_2400565_CWEC",
    "CAN_NU_BROUGHTON-ISLAND_2400570_CWEC",
    "CAN_NU_CAMBRIDGE-BAY-A_2400601_CWEC",
    "CAN_NU_CAPE-DORSET-CLIMATE_2400636_CWEC",
    "CAN_NU_CAPE-DYER_2400650_CWEC",
    "CAN_NU_CAPE-HOOPER_2400660_CWEC",
    "CAN_NU_CAPE-MERCY_2400F63_CWEC",
    "CAN_NU_CAPE-PEEL-WEST_2400697_CWEC",
    "CAN_NU_CLYDE-RIVER-CLIMATE_2400802_CWEC",
    "CAN_NU_CORAL-HARBOUR-A_2301002_CWEC",
    "CAN_NU_DEWAR-LAKES_2401030_CWEC",
    "CAN_NU_ENNADAI-LAKE-(AUT)_2301102_CWEC",
    "CAN_NU_EUREKA-A_2401203_CWEC",
    "CAN_NU_GJOA-HAVEN-CLIMATE_2302340_CWEC",
    "CAN_NU_GRISE-FIORD-CLIMATE_2402351_CWEC",
    "CAN_NU_HALL-BEACH-A_2402354_CWEC",
    "CAN_NU_HAT-ISLAND_2302370_CWEC",
    "CAN_NU_IQALUIT-A_2402596_CWEC",
    "CAN_NU_ISACHSEN-(AUT)_2402604_CWEC",
    "CAN_NU_KUGAARUK-CLIMATE_2303094_CWEC",
    "CAN_NU_KUGLUKTUK-A_2300903_CWEC",
    "CAN_NU_LONGSTAFF-BLUFF_2402684_CWEC",
    "CAN_NU_LUPIN-CS_230N002_CWEC",
    "CAN_NU_PANGNIRTUNG-A_2403054_CWEC",
    "CAN_NU_POND-INLET-A_2403206_CWEC",
    "CAN_NU_QIKIQTARJUAQ-CLIMATE_2400573_CWEC",
    "CAN_NU_RANKIN-INLET-A_2303405_CWEC",
    "CAN_NU_REA-POINT_2403450_CWEC",
    "CAN_NU_RESOLUTE-BAY-A_2403498_CWEC",
    "CAN_NU_RESOLUTION-ISLAND_2403602_CWEC",
    "CAN_NU_ROWLEY-ISLAND_2403625_CWEC",
    "CAN_NU_SHEPHERD-BAY-A_2303685_CWEC",
    "CAN_NU_TALOYOAK-A_2403855_CWEC",
]

prov_terr_codes = {
    "BRITISH COLUMBIA": "BC",
    "ALBERTA": "AB",
    "SASKATCHEWAN": "SK",
    "MANITOBA": "MB",
    "ONTARIO": "ON",
    "QUEBEC": "QC",
    "NEW BRUNSWICK": "NB",
    "NOVA SCOTIA": "NS",
    "PRINCE EDWARD ISLAND": "PE",
    "NEWFOUNDLAND AND LABRADOR": "NL",
    "YUKON": "YT",
    "NORTHWEST TERRITORIES": "NT",
    "NUNAVUT": "NU",
}


def get_cwec_file(weather_region, weather_location):
    # returns the name of the file without the file extension (e.g. .epw)
    default_file = canadian_cwec_files[0]

    weather_region = unidecode(weather_region)
    weather_location = unidecode(weather_location)
    if weather_region not in prov_terr_codes.keys():
        return default_file

    prov_terr_code = prov_terr_codes[weather_region]

    search_string = f"CAN_{prov_terr_code}_{weather_location}"

    prov_terr_files = list(
        filter(lambda x: f"CAN_{prov_terr_code}_" in x, canadian_cwec_files)
    )

    matches = difflib.get_close_matches(search_string, prov_terr_files)

    if matches:
        return matches[0]

    else:
        return default_file


def get_climate_zone(hdd):
    if hdd < 3000:
        return "4"
    elif hdd >= 3000 & hdd < 4000:
        return "5"
    elif hdd >= 4000 & hdd < 5000:
        return "6"
    elif hdd >= 5000 & hdd < 6000:
        return "7a"
    elif hdd >= 6000 & hdd < 7000:
        return "7b"
    else:
        return "8"
